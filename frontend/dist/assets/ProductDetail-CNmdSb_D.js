import{f as e,g as s,r,j as a,L as t}from"./react-vendor-KvxbO3mS.js";import{s as l,i,P as n,F as c}from"./index-D0fMXm6Q.js";import"./vendor-ZcaEhcQo.js";import"./editor-vendor-CSPj58cm.js";import"./supabase-DvSZys4T.js";function d(){const{id:d}=e();s();const[o,m]=r.useState(null),[x,h]=r.useState([]),[p,u]=r.useState([]),[g,j]=r.useState(!0),[y,b]=r.useState(1),[v,f]=r.useState("description"),[N,w]=r.useState(!1),[_,k]=r.useState({reviewer_name:"",reviewer_phone:"",reviewer_location:"",rating:5,review_text:""}),[C,L]=r.useState(!1),[M,S]=r.useState(!1),[q,B]=r.useState(!1),[z,W]=r.useState({customer_name:"",customer_phone:"",customer_email:"",delivery_address:"",delivery_area:"rangpur",order_notes:""}),[X,O]=r.useState(!1),[I,P]=r.useState(0);r.useEffect(()=>{!async function(){try{if(!l||!i)return void j(!1);const{data:e,error:s}=await l.from("products").select("*").eq("id",d).single();if(s)throw s;m(e);const{data:r}=await l.from("product_reviews").select("*").eq("product_id",d).or("is_approved.eq.true,is_admin_review.eq.true").order("created_at",{ascending:!1});if(u(r||[]),e?.category){const{data:s}=await l.from("products").select("*").eq("is_active",!0).eq("category",e.category).neq("id",d).limit(4);h(s||[])}}catch(e){}finally{j(!1)}}()},[d]);const H="rangpur"===z.delivery_area?0:150,D=o?(o.sale_price||o.price)*y:0,F=D+H;if(g)return a.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"animate-pulse",children:a.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[a.jsx("div",{className:"bg-gray-200 rounded-2xl h-96"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-3/4"}),a.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),a.jsx("div",{className:"h-24 bg-gray-200 rounded"})]})]})})})});if(!o)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"পণ্য পাওয়া যায়নি"}),a.jsx(t,{to:"/medi-products",className:"text-primary-600 hover:underline",children:"সকল পণ্য দেখুন"})]})});const R=o.sale_price&&o.sale_price<o.price,T=R?Math.round((o.price-o.sale_price)/o.price*100):0,V=[o.image_url,...o.additional_images||[]].filter(Boolean);return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:a.jsxs("nav",{className:"flex items-center gap-2 text-sm",children:[a.jsx(t,{to:"/",className:"text-gray-500 hover:text-primary-600",children:"হোম"}),a.jsx("span",{className:"text-gray-300",children:"/"}),a.jsx(t,{to:"/medi-products",className:"text-gray-500 hover:text-primary-600",children:"মেডি পণ্য"}),a.jsx("span",{className:"text-gray-300",children:"/"}),a.jsx("span",{className:"text-gray-800 font-medium",children:o.name})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"bg-white rounded-3xl shadow-sm overflow-hidden",children:a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 p-6 md:p-8",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"relative aspect-square rounded-2xl overflow-hidden bg-gray-50 mb-4",children:[a.jsx("img",{src:V[I]||"https://via.placeholder.com/500",alt:o.name,className:"w-full h-full object-cover"}),R&&a.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white font-bold px-3 py-1 rounded-full",children:["-",T,"% ছাড়"]})]}),V.length>1&&a.jsx("div",{className:"flex gap-2 overflow-x-auto",children:V.map((e,s)=>a.jsx("button",{onClick:()=>P(s),className:"flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 "+(I===s?"border-primary-500":"border-gray-200"),children:a.jsx("img",{src:e,alt:"",className:"w-full h-full object-cover"})},s))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.category&&a.jsx("span",{className:"bg-primary-50 text-primary-700 px-3 py-1 rounded-full text-sm font-medium",children:o.category}),o.is_featured&&a.jsxs("span",{className:"bg-amber-50 text-amber-700 px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"জনপ্রিয়"]})]}),a.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 mb-4",children:o.name}),a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(e=>a.jsx("svg",{className:"w-5 h-5 "+(e<=Math.round(o.average_rating||0)?"text-amber-400":"text-gray-200"),fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},e))}),a.jsxs("span",{className:"text-gray-600",children:["(",p.length," রিভিউ)"]})]}),a.jsx("div",{className:"flex items-baseline gap-4 mb-6",children:R?a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"text-3xl font-bold text-primary-600",children:["৳",o.sale_price]}),a.jsxs("span",{className:"text-xl text-gray-400 line-through",children:["৳",o.price]}),a.jsxs("span",{className:"bg-red-100 text-red-600 px-2 py-1 rounded text-sm font-medium",children:[T,"% ছাড়"]})]}):a.jsxs("span",{className:"text-3xl font-bold text-primary-600",children:["৳",o.price]})}),o.short_description&&a.jsx("p",{className:"text-gray-600 mb-6",children:o.short_description}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-green-50 rounded-xl p-4 flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-green-800",children:"১০০% অরিজিনাল"}),a.jsx("div",{className:"text-sm text-green-600",children:"গুণগত মান নিশ্চিত"})]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:a.jsxs("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{d:"M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"})]})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-blue-800",children:"দ্রুত ডেলিভারি"}),a.jsx("div",{className:"text-sm text-blue-600",children:"রংপুরে ফ্রি"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx("span",{className:"text-gray-700 font-medium",children:"পরিমাণ:"}),a.jsxs("div",{className:"flex items-center border border-gray-200 rounded-xl",children:[a.jsx("button",{onClick:()=>b(Math.max(1,y-1)),className:"w-10 h-10 flex items-center justify-center text-gray-600 hover:bg-gray-100",children:"-"}),a.jsx("span",{className:"w-12 text-center font-semibold",children:y}),a.jsx("button",{onClick:()=>b(y+1),className:"w-10 h-10 flex items-center justify-center text-gray-600 hover:bg-gray-100",children:"+"})]}),o.stock_quantity>0&&a.jsxs("span",{className:"text-green-600 text-sm",children:["স্টকে আছে (",o.stock_quantity,"টি)"]})]}),a.jsxs("button",{onClick:()=>B(!0),className:"w-full bg-primary-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-primary-700 transition-colors flex items-center justify-center gap-2",children:[a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"এখনই অর্ডার করুন"]}),a.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-xl",children:a.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsx("svg",{className:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),a.jsx("span",{children:"বিকাশে পেমেন্ট করুন"})]})})]})]})}),a.jsxs("div",{className:"bg-white rounded-3xl shadow-sm mt-8 overflow-hidden",children:[a.jsx("div",{className:"border-b",children:a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:()=>f("description"),className:"px-6 py-4 font-medium "+("description"===v?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"),children:"বিবরণ"}),a.jsx("button",{onClick:()=>f("usage"),className:"px-6 py-4 font-medium "+("usage"===v?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"),children:"ব্যবহার বিধি"}),a.jsxs("button",{onClick:()=>f("reviews"),className:"px-6 py-4 font-medium "+("reviews"===v?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"),children:["রিভিউ (",p.length,")"]})]})}),a.jsxs("div",{className:"p-6 md:p-8",children:["description"===v&&a.jsxs("div",{className:"prose max-w-none",children:[a.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:o.description||"বিবরণ পাওয়া যায়নি।"}),o.ingredients&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"উপাদান"}),a.jsx("p",{className:"text-gray-600",children:o.ingredients})]}),o.manufacturer&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"প্রস্তুতকারক"}),a.jsx("p",{className:"text-gray-600",children:o.manufacturer})]})]}),"usage"===v&&a.jsxs("div",{children:[o.usage_instructions?a.jsxs("div",{className:"bg-primary-50 rounded-xl p-6",children:[a.jsxs("h4",{className:"font-semibold text-primary-800 mb-3 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"ব্যবহার বিধি"]}),a.jsx("p",{className:"text-primary-700",children:o.usage_instructions})]}):a.jsx("p",{className:"text-gray-500",children:"ব্যবহার বিধি পাওয়া যায়নি।"}),o.warnings&&a.jsxs("div",{className:"bg-red-50 rounded-xl p-6 mt-4",children:[a.jsxs("h4",{className:"font-semibold text-red-800 mb-3 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"সতর্কতা"]}),a.jsx("p",{className:"text-red-700",children:o.warnings})]})]}),"reviews"===v&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"গ্রাহক রিভিউ"}),a.jsx("button",{onClick:()=>w(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700",children:"রিভিউ লিখুন"})]}),p.length>0?a.jsx("div",{className:"space-y-4",children:p.map(e=>a.jsxs("div",{className:"border-b border-gray-100 pb-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-gray-800",children:e.reviewer_name}),e.is_verified_purchase&&a.jsx("span",{className:"bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs",children:"যাচাইকৃত ক্রেতা"})]}),e.reviewer_location&&a.jsx("span",{className:"text-sm text-gray-500",children:e.reviewer_location})]}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(s=>a.jsx("svg",{className:"w-4 h-4 "+(s<=e.rating?"text-amber-400":"text-gray-200"),fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},s))})]}),a.jsx("p",{className:"text-gray-700",children:e.review_text})]},e.id))}):a.jsx("p",{className:"text-gray-500 text-center py-8",children:"এই পণ্যে এখনো কোনো রিভিউ নেই। প্রথম রিভিউ দিন!"})]})]})]}),x.length>0&&a.jsxs("div",{className:"mt-12",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:"সম্পর্কিত পণ্য"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6",children:x.map(e=>a.jsx(n,{product:e},e.id))})]})]}),N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"রিভিউ লিখুন"}),a.jsx("button",{onClick:()=>{w(!1),S(!1)},className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),M?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"রিভিউ সফলভাবে জমা হয়েছে!"}),a.jsx("p",{className:"text-gray-600",children:"এডমিন অ্যাপ্রুভ করার পর আপনার রিভিউ দেখা যাবে।"})]}):a.jsxs("form",{onSubmit:async function(e){if(e.preventDefault(),_.reviewer_name&&_.review_text){L(!0);try{const{error:e}=await l.from("product_reviews").insert([{product_id:d,..._,is_approved:!1,is_admin_review:!1}]);if(e)throw e;S(!0),k({reviewer_name:"",reviewer_phone:"",reviewer_location:"",rating:5,review_text:""})}catch(s){alert("রিভিউ জমা দিতে সমস্যা হয়েছে।")}finally{L(!1)}}else alert("অনুগ্রহ করে নাম এবং রিভিউ লিখুন")},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"আপনার নাম *"}),a.jsx("input",{type:"text",value:_.reviewer_name,onChange:e=>k({..._,reviewer_name:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ফোন নম্বর"}),a.jsx("input",{type:"tel",value:_.reviewer_phone,onChange:e=>k({..._,reviewer_phone:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"অবস্থান"}),a.jsx("input",{type:"text",value:_.reviewer_location,onChange:e=>k({..._,reviewer_location:e.target.value}),placeholder:"যেমন: রংপুর সদর",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"রেটিং *"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(e=>a.jsx("button",{type:"button",onClick:()=>k({..._,rating:e}),className:"p-1",children:a.jsx("svg",{className:"w-8 h-8 "+(e<=_.rating?"text-amber-400":"text-gray-200"),fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},e))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"আপনার রিভিউ *"}),a.jsx("textarea",{value:_.review_text,onChange:e=>k({..._,review_text:e.target.value}),rows:"4",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),a.jsx("button",{type:"submit",disabled:C,className:"w-full bg-primary-600 text-white py-3 rounded-lg font-medium hover:bg-primary-700 disabled:opacity-50",children:C?"জমা দেওয়া হচ্ছে...":"রিভিউ জমা দিন"})]})]})})}),q&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"অর্ডার করুন"}),a.jsx("button",{onClick:()=>B(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex gap-4",children:[a.jsx("img",{src:o.image_url,alt:o.name,className:"w-20 h-20 rounded-lg object-cover"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:o.name}),a.jsxs("p",{className:"text-primary-600 font-bold",children:["৳",o.sale_price||o.price," × ",y]})]})]})}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),async function(){O(!0);try{const e="rangpur"===z.delivery_area?0:150,s=(o.sale_price||o.price)*y,r=s+e,a="ORD"+Date.now().toString().slice(-8);sessionStorage.setItem("pendingProductOrder",JSON.stringify({orderForm:z,productId:d,productName:o.name,productPrice:o.sale_price||o.price,quantity:y,deliveryCharge:e,subtotal:s,totalAmount:r,orderNumber:a}));const t=await fetch("/api/bkash/create-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:r,payerReference:z.customer_phone,merchantInvoiceNumber:a,paymentType:"product"})}),l=await t.json();l.success&&l.bkashURL?(sessionStorage.setItem("paymentType","product_order"),window.location.href=l.bkashURL):(sessionStorage.removeItem("pendingProductOrder"),alert(l.message||"পেমেন্ট শুরু করতে সমস্যা হয়েছে।"))}catch(e){sessionStorage.removeItem("pendingProductOrder"),alert("পেমেন্ট শুরু করতে সমস্যা হয়েছে।")}finally{O(!1)}}()},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"আপনার নাম *"}),a.jsx("input",{type:"text",value:z.customer_name,onChange:e=>W({...z,customer_name:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ফোন নম্বর *"}),a.jsx("input",{type:"tel",value:z.customer_phone,onChange:e=>W({...z,customer_phone:e.target.value}),placeholder:"01XXXXXXXXX",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ইমেইল (ঐচ্ছিক)"}),a.jsx("input",{type:"email",value:z.customer_email,onChange:e=>W({...z,customer_email:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ডেলিভারি এলাকা *"}),a.jsxs("select",{value:z.delivery_area,onChange:e=>W({...z,delivery_area:e.target.value}),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[a.jsx("option",{value:"rangpur",children:"রংপুর শহর (ফ্রি ডেলিভারি)"}),a.jsx("option",{value:"outside_rangpur",children:"রংপুরের বাইরে (৳১৫০ ডেলিভারি চার্জ)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"সম্পূর্ণ ঠিকানা *"}),a.jsx("textarea",{value:z.delivery_address,onChange:e=>W({...z,delivery_address:e.target.value}),rows:"3",placeholder:"বাড়ি নম্বর, রোড, এলাকা, জেলা",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"অতিরিক্ত মন্তব্য (ঐচ্ছিক)"}),a.jsx("textarea",{value:z.order_notes,onChange:e=>W({...z,order_notes:e.target.value}),rows:"2",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-gray-600",children:[a.jsxs("span",{children:["সাবটোটাল (",y,"টি পণ্য)"]}),a.jsxs("span",{children:["৳",D]})]}),a.jsxs("div",{className:"flex justify-between text-gray-600",children:[a.jsx("span",{children:"ডেলিভারি চার্জ"}),a.jsx("span",{className:0===H?"text-green-600":"",children:0===H?"ফ্রি":`৳${H}`})]}),a.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold text-gray-800",children:[a.jsx("span",{children:"মোট"}),a.jsxs("span",{className:"text-primary-600",children:["৳",F]})]})]}),a.jsx("button",{type:"submit",disabled:X,className:"w-full bg-pink-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-pink-700 disabled:opacity-50 flex items-center justify-center gap-2",children:X?"প্রসেসিং...":a.jsxs(a.Fragment,{children:[a.jsx("img",{src:"https://www.bkash.com/sites/all/themes/flavor/images/bkash_logo.svg",alt:"bKash",className:"h-6"}),"বিকাশে পেমেন্ট করুন"]})})]})]})})}),a.jsx(c,{})]})}export{d as default};
