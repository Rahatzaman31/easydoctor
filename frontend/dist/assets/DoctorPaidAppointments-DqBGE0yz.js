import{g as e,r as t,j as s}from"./react-vendor-KvxbO3mS.js";import{s as l,i as a}from"./index-D0fMXm6Q.js";import{D as n}from"./DoctorAdminSidebar-UPJWOQbi.js";import"./vendor-ZcaEhcQo.js";import"./editor-vendor-CSPj58cm.js";import"./supabase-DvSZys4T.js";function r(){const r=e(),[i,d]=t.useState([]),[o,c]=t.useState(!0),[x,p]=t.useState(""),[m,h]=t.useState("all"),[g,u]=t.useState({daily:0,weekly:0,monthly:0}),[j,f]=t.useState(!1),[b,y]=t.useState(null),[N,w]=t.useState(""),[v,_]=t.useState(!1),k=localStorage.getItem("doctorId");async function D(){try{if(!l||!a||!k)return void c(!1);const{data:e,error:t}=await l.from("paid_appointments").select("*").eq("doctor_id",k).in("status",["confirmed","completed"]).order("appointment_date",{ascending:!1});if(t)throw t;d(e||[]),function(e){const t=new Date,s=t.toISOString().split("T")[0],l=new Date(t);l.setDate(l.getDate()-7);const a=new Date(t);a.setMonth(a.getMonth()-1);const n=e.filter(e=>e.appointment_date===s&&"confirmed"===e.status).length,r=e.filter(e=>new Date(e.appointment_date)>=l&&"completed"===e.status).length,i=e.filter(e=>new Date(e.appointment_date)>=a&&"completed"===e.status).length;u({daily:n,weekly:r,monthly:i})}(e||[])}catch(e){}finally{c(!1)}}function C(e){return e?new Date(e).toLocaleDateString("bn-BD",{year:"numeric",month:"short",day:"numeric"}):"-"}function S(e){y(e),w(e.prescription_url||""),f(!0)}t.useEffect(()=>{localStorage.getItem("doctorLoggedIn")?D():r("/doctor.admin/login")},[]);const L=function(){let e=i;x&&(e=e.filter(e=>e.patient_name?.toLowerCase().includes(x.toLowerCase())||e.booking_ref?.toLowerCase().includes(x.toLowerCase())||e.patient_phone?.includes(x)));const t=new Date,s=t.toISOString().split("T")[0];if("all"===m)e=e.filter(e=>"completed"===e.status);else if("today"===m)e=e.filter(e=>e.appointment_date===s&&"confirmed"===e.status);else if("week"===m){const s=new Date(t);s.setDate(s.getDate()-7),e=e.filter(e=>new Date(e.appointment_date)>=s&&"completed"===e.status)}else if("month"===m){const s=new Date(t);s.setMonth(s.getMonth()-1),e=e.filter(e=>new Date(e.appointment_date)>=s&&"completed"===e.status)}return e}();return s.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[s.jsx(n,{}),s.jsxs("div",{className:"flex-1 p-4 pt-16 lg:pt-6 lg:p-8",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-800",children:"ржкрзЗржЗржб рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓"}),s.jsx("p",{className:"text-gray-500 mt-1",children:"ржЖржкржирж╛рж░ ржкрзЗржЗржб ржЕрзНржпрж╛ржкржпрж╝рзЗржирзНржЯржорзЗржирзНржЯ рж╕ржорзВрж╣"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-4 lg:p-6 text-white shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:"ЁЯТО"}),s.jsx("span",{className:"text-white/80 text-sm",children:"ржЖржЬржХрзЗ"})]}),s.jsx("p",{className:"text-2xl lg:text-3xl font-bold",children:g.daily}),s.jsx("p",{className:"text-white/70 text-sm",children:"рж░рзЛржЧрзА"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-pink-500 to-rose-500 rounded-2xl p-4 lg:p-6 text-white shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:"ЁЯУЖ"}),s.jsx("span",{className:"text-white/80 text-sm",children:"ржПржЗ рж╕ржкрзНрждрж╛рж╣рзЗ"})]}),s.jsx("p",{className:"text-2xl lg:text-3xl font-bold",children:g.weekly}),s.jsx("p",{className:"text-white/70 text-sm",children:"рж░рзЛржЧрзА"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-2xl p-4 lg:p-6 text-white shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:"ЁЯЧУя╕П"}),s.jsx("span",{className:"text-white/80 text-sm",children:"ржПржЗ ржорж╛рж╕рзЗ"})]}),s.jsx("p",{className:"text-2xl lg:text-3xl font-bold",children:g.monthly}),s.jsx("p",{className:"text-white/70 text-sm",children:"рж░рзЛржЧрзА"})]})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-md p-4 lg:p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx("input",{type:"text",placeholder:"ржирж╛ржо, рж░рзЗржл ржиржорзНржмрж░ ржмрж╛ ржлрзЛржи ржжрж┐ржпрж╝рзЗ ржЦрзБржБржЬрзБржи...",value:x,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500"})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>h("all"),className:"px-4 py-2 rounded-lg text-sm font-medium "+("all"===m?"bg-purple-600 text-white":"bg-gray-100 text-gray-700"),children:"рж╕ржм"}),s.jsx("button",{onClick:()=>h("today"),className:"px-4 py-2 rounded-lg text-sm font-medium "+("today"===m?"bg-purple-600 text-white":"bg-gray-100 text-gray-700"),children:"ржЖржЬржХрзЗ"}),s.jsx("button",{onClick:()=>h("week"),className:"px-4 py-2 rounded-lg text-sm font-medium "+("week"===m?"bg-purple-600 text-white":"bg-gray-100 text-gray-700"),children:"ржПржЗ рж╕ржкрзНрждрж╛рж╣"}),s.jsx("button",{onClick:()=>h("month"),className:"px-4 py-2 rounded-lg text-sm font-medium "+("month"===m?"bg-purple-600 text-white":"bg-gray-100 text-gray-700"),children:"ржПржЗ ржорж╛рж╕"})]})]})}),o?s.jsx("div",{className:"text-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"})}):0===L.length?s.jsxs("div",{className:"bg-white rounded-xl shadow-md p-12 text-center",children:[s.jsx("span",{className:"text-5xl mb-4 block",children:"ЁЯТО"}),s.jsx("p",{className:"text-gray-500 text-lg",children:"ржХрзЛржирзЛ ржкрзЗржЗржб ржЕрзНржпрж╛ржкржпрж╝рзЗржирзНржЯржорзЗржирзНржЯ ржирзЗржЗ"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"hidden lg:block bg-white rounded-xl shadow-md overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{className:"text-left text-gray-600",children:[s.jsx("th",{className:"px-6 py-4 text-sm font-semibold",children:"рж░рзЗржл ржиржорзНржмрж░"}),s.jsx("th",{className:"px-6 py-4 text-sm font-semibold",children:"рж░рзЛржЧрзАрж░ ржирж╛ржо"}),s.jsx("th",{className:"px-6 py-4 text-sm font-semibold",children:"ржлрзЛржи"}),s.jsx("th",{className:"px-6 py-4 text-sm font-semibold",children:"рждрж╛рж░рж┐ржЦ"}),s.jsx("th",{className:"px-6 py-4 text-sm font-semibold",children:"ржкрзЗржорзЗржирзНржЯ"}),s.jsx("th",{className:"px-6 py-4 text-sm font-semibold",children:"ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи"}),s.jsx("th",{className:"px-6 py-4 text-sm font-semibold",children:"ржЕрзНржпрж╛ржХрж╢ржи"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:L.map(e=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 font-medium text-purple-600",children:e.booking_ref}),s.jsxs("td",{className:"px-6 py-4",children:[s.jsx("p",{className:"font-medium text-gray-800",children:e.patient_name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[e.patient_age," ржмржЫрж░, ","male"===e.patient_gender?"ржкрзБрж░рзБрж╖":"ржорж╣рж┐рж▓рж╛"]})]}),s.jsx("td",{className:"px-6 py-4 text-gray-600",children:e.patient_phone}),s.jsx("td",{className:"px-6 py-4 text-gray-600",children:C(e.appointment_date)}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+("paid"===e.payment_status?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:"paid"===e.payment_status?"ржкрзЗржЗржб":"ржЕржкрзЗржХрзНрж╖ржорж╛ржи"})}),s.jsx("td",{className:"px-6 py-4",children:e.prescription_url?s.jsxs("a",{href:e.prescription_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm flex items-center gap-1",children:[s.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"ржжрзЗржЦрзБржи"]}):s.jsx("span",{className:"text-gray-400 text-sm",children:"ржЖржкрж▓рзЛржб рж╣ржпрж╝ржирж┐"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("button",{onClick:()=>S(e),className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-lg text-sm font-medium hover:bg-purple-200",children:e.prescription_url?"ржЖржкржбрзЗржЯ":"ржЖржкрж▓рзЛржб"})})]},e.id))})]})}),s.jsx("div",{className:"lg:hidden space-y-3",children:L.map(e=>s.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsx("span",{className:"font-medium text-purple-600 text-sm",children:e.booking_ref}),s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("paid"===e.payment_status?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:"paid"===e.payment_status?"ржкрзЗржЗржб":"ржЕржкрзЗржХрзНрж╖ржорж╛ржи"})]}),s.jsx("p",{className:"font-medium text-gray-800",children:e.patient_name}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-sm text-gray-500",children:[s.jsxs("span",{children:["ЁЯУЮ ",e.patient_phone]}),s.jsxs("span",{children:["ЁЯУЕ ",C(e.appointment_date)]})]}),s.jsxs("div",{className:"flex gap-2 mt-3 pt-3 border-t",children:[s.jsx("button",{onClick:()=>S(e),className:"flex-1 py-2 bg-purple-100 text-purple-700 rounded-lg text-sm font-medium",children:e.prescription_url?"ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи ржЖржкржбрзЗржЯ":"ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи ржЖржкрж▓рзЛржб"}),e.prescription_url&&s.jsx("a",{href:e.prescription_url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg text-sm font-medium",children:"ржжрзЗржЦрзБржи"})]})]},e.id))})]})]}),j&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи ржЖржкрж▓рзЛржб"}),s.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-xl",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"рж░рзЛржЧрзА:"})," ",b?.patient_name]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"рж░рзЗржл:"})," ",b?.booking_ref]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи URL"}),s.jsx("input",{type:"url",value:N,onChange:e=>w(e.target.value),placeholder:"https://example.com/prescription.jpg",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500"}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи ржЫржмрж┐ ржЖржкрж▓рзЛржб ржХрж░рзЗ URL ржжрж┐ржи (Google Drive, Imgur ржЗрждрзНржпрж╛ржжрж┐)"})]})]}),s.jsxs("div",{className:"p-6 border-t flex gap-3",children:[s.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-3 border border-gray-300 rounded-xl font-semibold text-gray-600",children:"ржмрж╛рждрж┐рж▓"}),s.jsx("button",{onClick:async function(){if(N.trim()){_(!0);try{const{error:e}=await l.from("paid_appointments").update({prescription_url:N}).eq("id",b.id);if(e)throw e;alert("ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи рж╕ржлрж▓ржнрж╛ржмрзЗ ржЖржкрж▓рзЛржб рж╣ржпрж╝рзЗржЫрзЗ!"),f(!1),D()}catch(e){alert("ржЖржкрж▓рзЛржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ")}finally{_(!1)}}else alert("ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи URL ржжрж┐ржи")},disabled:v,className:"flex-1 py-3 bg-purple-600 text-white rounded-xl font-semibold hover:bg-purple-700 disabled:opacity-50",children:v?"рж╕ржВрж░ржХрзНрж╖ржг рж╣ржЪрзНржЫрзЗ...":"рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи"})]})]})})]})}export{r as default};
